{% load static %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <title>{{ pdv.nom }} — Réalisations</title>
</head>
<body class="bg-gray-50 min-h-screen">
  <header class="p-4 bg-white shadow sticky top-0">
    <a href="{% url 'client_realisations' %}" class="text-blue-600">← Retour</a>
    <h1 class="font-bold mt-2">{{ pdv.nom }}</h1>
    <p class="text-xs text-gray-500">{{ pdv.wilaya }} — {{ pdv.region }}</p>
  </header>

  <main class="p-4">
    {% for cat, data in categories.items %}
      <section class="mb-6">
        <div class="flex items-center justify-between mb-2">
          <h2 class="font-semibold">{{ cat }}</h2>
          <div class="text-xs text-gray-500">{{ data.realisations|length }} enregistrements</div>
        </div>

        <!-- carrousel horizontal -->
        <div class="flex overflow-x-auto gap-3 pb-2">
          {% for ph in data.photos %}
            <div class="min-w-[70%] md:min-w-[45%] bg-white rounded-lg shadow overflow-hidden">
              <img src="{{ ph.image.url }}" class="w-full h-48 object-cover">
              <div class="p-2 text-xs">
                <div class="font-semibold">
                  {% if ph.mission %}
                    {{ ph.mission.code }}
                  {% endif %}
                </div>
                <div class="text-gray-500">{{ ph.type_photo }} • {{ ph.created_at|date:"d/m/Y H:i" }}</div>
              </div>
            </div>
          {% endfor %}

          {% for r in data.realisations %}
            <div class="min-w-[70%] md:min-w-[45%] bg-white rounded-lg shadow p-3">
              <div class="font-semibold">
                {% if r.produit %}
                  {{ r.produit.nom }}
                {% endif %}
              </div>
              <div class="text-xs text-gray-500">{{ r.date_realisation }} • {{ r.merch.first_name }} {{ r.merch.last_name }}</div>
              <div class="mt-2 text-sm">Disponible: {{ r.disponible }} · Prix: {{ r.prix_vente }}</div>
            </div>
          {% endfor %}
        </div>
      </section>
    {% empty %}
      <div class="text-gray-500">Aucune donnée pour ce PDV.</div>
    {% endfor %}
  </main>
</body>
</html>
